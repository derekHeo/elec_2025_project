> best_model ë‚´ë¶€ì— ìˆëŠ” íŒŒì¼ë“¤ì€ ì‹¤ì œ 1ë“±íŒ€ì—ì„œ ì“´ íŒŒì¼ì´ê³  ê·¸ íŒŒì¼ì„ í† ëŒ€ë¡œ ë‚´ê°€ 
max_point_pipeline.ipynbë¼ëŠ” ëª…ì¹­ì˜ ì¹´í”¼ ì½”ë“œë¥¼ ì‘ì„±í•´ë´¤ì–´. ì € ë² ìŠ¤íŠ¸ëª¨ë¸ê³¼ ë‚´ ì½”ë“œê°„ì˜ ì°¨ì´ì ê³¼ ê³µí†µì ì„ 
ë§í•´ì¤„ë˜? 

â— best_model ë””ë ‰í† ë¦¬ì™€ max_point_pipeline.ipynb íŒŒì¼ì„ ë¹„êµ ë¶„ì„í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

â— Search(pattern: "best_model/**/*")
  â¿  Found 8 files (ctrl+o to expand)

â— Read(max_point_pipeline.ipynb)
  â¿  Read 27 cells

â— Read(best_model\preprocess.ipynb)
  â¿  Read 11 cells

â— Read(best_model\stacking_tabpfn.ipynb)
  â¿  Read 13 cells

â— Read(best_model\ensemble.ipynb)
  â¿  Read 1 cells

â— 1ë“±íŒ€ì˜ best_model ì½”ë“œì™€ ë‹¹ì‹ ì˜ max_point_pipeline.ipynbë¥¼ ë¹„êµ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.

  ğŸ¯ ì£¼ìš” ì°¨ì´ì 

  1. ì½”ë“œ êµ¬ì¡°

  - best_model: ëª¨ë“ˆí™”ëœ êµ¬ì¡° (preprocess.ipynb, stacking_tabpfn.ipynb, ensemble.ipynb ë¶„ë¦¬)     
  - max_point_pipeline: ëª¨ë“  ê²ƒì„ í•˜ë‚˜ì˜ ë…¸íŠ¸ë¶ì— í†µí•©

  2. ì „ì²˜ë¦¬ ì„¸ë¶€ì‚¬í•­

  mean_std_power í•¨ìˆ˜ì˜ ìŠ¤ì¼€ì¼ë§ ë¹„ìœ¨
  - best_model (preprocess.ipynb:c31da4ec):
  base_ratio = np.array([0.985] + [0.98]*2 + [0.995]*2 + [0.99]*2)
  ratio_all = base_ratio - 0.005
  - â†’ ìš”ì¼ë³„ë¡œ ë‹¤ë¥¸ ë¹„ìœ¨ ì ìš© (ì›”~ì¼ ê°ê° ë‹¤ë¦„)
  - max_point_pipeline:
  base_ratio = np.array([1.0] * 7)
  ratio_all = base_ratio - 0
  - â†’ ëª¨ë“  ìš”ì¼ì— ë™ì¼í•œ ë¹„ìœ¨ (1.0)

  dow_hour_mean ê³„ì‚° ì‹œ ì œì™¸ ê·œì¹™
  - best_model: ê³µíœ´ì¼(6/6, 8/15) + ë¶ˆê·œì¹™ íœ´ì¼ì˜ datesë§Œ ì œì™¸
  - max_point_pipeline: ê³µíœ´ì¼(6/6, 8/15)ë§Œ ì œì™¸

  3. ì´ìƒì¹˜ ì œê±°

  Research Institute 53ë²ˆ ê±´ë¬¼
  - best_model (preprocess.ipynb:2ec7116e): íŠ¹ë³„ ì²˜ë¦¬ ì—†ìŒ
  - max_point_pipeline: íŠ¹ë³„ ì²˜ë¦¬ ì¶”ê°€
  # 1) 2024-06-15, 2024-06-16 ì „ì²´ ì œê±°
  # 2) 2024-08-17 ì´í›„ power_consumption <= 1000 ì œê±°

  4. ëª¨ë¸ë§ ë°©ë²•

  Cross-Validation
  - best_model: 10-fold CV
  - max_point_pipeline: 5-fold CV (GPU ìµœì í™”)

  ë°ì´í„° íƒ€ì… ìµœì í™”
  - best_model: ê¸°ë³¸ íƒ€ì… ì‚¬ìš©
  - max_point_pipeline: float32 ì‚¬ìš©ìœ¼ë¡œ GPU ì„±ëŠ¥ í–¥ìƒ

  Validation ë¶„í• 
  - best_model (preprocess.ipynb:20d8e470):
  val_date = split_date - pd.Timedelta(days=7)
  x_train = combined_df[combined_df['date_time'] < val_date].copy()
  x_val = combined_df[(combined_df['date_time'] >= val_date) & ...].copy()
  - max_point_pipeline: validation ì…‹ ì—†ì´ ì „ì²´ í•™ìŠµ ë°ì´í„° ì‚¬ìš©

  5. ì•™ìƒë¸” ì „ëµ â­ (ê°€ì¥ í° ì°¨ì´)

  best_model (ensemble.ipynb):
  pfn_5seed = (ans1 + ans2 + ans3 + ans4 + ans5) / 5  # 5ê°œ ì‹œë“œ
  final_answer = (
      0.9 * (0.5 * pfn_5seed + 0.5 * (0.75 * ans8 + 0.25 * ans7)) +
      0.1 * ans6
  )
  - 5ê°œ ì‹œë“œë¡œ TabPFN 5ë²ˆ ì‹¤í–‰ í›„ í‰ê· 
  - AutoGluon ëª¨ë¸ ì¶”ê°€
  - ê±´ë¬¼ íƒ€ì…ë³„(bytype) TabPFN ì¶”ê°€
  - ë³µì¡í•œ ê°€ì¤‘ ì•™ìƒë¸”

  max_point_pipeline:
  - ë‹¨ì¼ TabPFN Stackingë§Œ ì‚¬ìš©
  - ì•™ìƒë¸” ì—†ìŒ

  6. ì‹¤í–‰ í™˜ê²½

  - best_model: ë¡œì»¬ í™˜ê²½ (./data/)
  - max_point_pipeline: Google Colab (/content/drive/MyDrive/)

  ---
  âœ… ê³µí†µì 

  1. ë™ì¼í•œ Feature Engineering
    - CDH, CDD, THI, WCT
    - summer_cycle_features
    - ì˜¨ë„/ìŠµë„ í†µê³„ features
    - weekly_slope
    - cyclic features (sin/cos)
  2. ë™ì¼í•œ íœ´ì¼ ì„¤ì • ë¡œì§
    - ê±´ë¬¼ë³„ ì„¸ë°€í•œ íœ´ì¼ ê·œì¹™
    - Department Store, Research Institute ë“± ê°œë³„ ì²˜ë¦¬
  3. TabPFN + Linear Regression Stacking
    - ê±´ë¬¼ë³„ ëª¨ë¸ í•™ìŠµ
    - KFoldë¡œ meta feature ìƒì„±
    - LinearRegressionìœ¼ë¡œ meta learner
  4. ë™ì¼í•œ ì´ìƒì¹˜ ì œê±° ê·œì¹™ (53ë²ˆ ì œì™¸)

  ---
  ğŸ“Š ì„±ëŠ¥ ì°¨ì´ì˜ ì£¼ìš” ì›ì¸

  1. ì•™ìƒë¸”: best_modelì€ 5ê°œ ì‹œë“œ + AutoGluon + íƒ€ì…ë³„ ëª¨ë¸ì„ ë³µì¡í•˜ê²Œ ì¡°í•©
  2. ì „ì²˜ë¦¬ ë””í…Œì¼: ìš”ì¼ë³„ ìŠ¤ì¼€ì¼ë§ ë¹„ìœ¨ ì°¨ì´
  3. CV fold ìˆ˜: 10-fold vs 5-fold

  ë‹¹ì‹ ì˜ ì½”ë“œëŠ” 1ë“±íŒ€ì˜ í•µì‹¬ ë¡œì§ì„ ë‹¨ìˆœí™”í•œ ë²„ì „ìœ¼ë¡œ, ì „ì²´ íŒŒì´í”„ë¼ì¸ì„ í•˜ë‚˜ì˜ ë…¸íŠ¸ë¶ìœ¼ë¡œ ì¬í˜„í•œ ê²ƒì…ë‹ˆë‹¤!

> ê·¸ëŸ¬ë©´ ë‚´ max_point_pipeline ì½”ë“œì—ì„œ ê°€ì¥ ê°€ë³ê²Œ ì‹¤ì²œì´ ê°€ëŠ¥í•œ ë°©ë²•ë“¤ì„ ê°ê° ì¶”ì²œí•´ì¤˜.        
ì™œëƒí•˜ë©´, ì´ê±´ í…€í”„ë¡œì íŠ¸ì˜ ì ìˆ˜ íšë“ ê¸°ì¤€ì´ ìˆëŠ”ë°, ì´ ì ìˆ˜ íšë“ ê¸°ì¤€ì€ ë² ì´ìŠ¤ë¼ì¸ ì½”ë“œ ëŒ€ë¹„    
 ì–´ë–¤ ê°œì„ ì„ ì§„í–‰í–ˆëŠëƒ ê±°ë“ ? ê·¸ë˜ì„œ ì¢€ ë¶ˆê°€í”¼í•˜ê²Œ ë³€ì£¼ë¥¼ ì£¼ëŠ” ì‘ì—…ì„ í•´ì•¼ë ê±°ê°™ì•„.

1. ìƒˆë¡œìš´ feature ìƒì„± ë° ë°˜ì˜ 
2. ì•™ìƒë¸” ì ìš©
3. í•˜ì´í¼íŒŒë¼ë¯¸í„° ë³€ê²½
4. ìƒˆë¡œìš´ ë„ˆë§Œì˜ ì†”ë£¨ì…˜ ë„ì…

ìµœëŒ€í•œ ì ì€ ë¦¬ì†ŒìŠ¤ë¥¼ ë“¤ì—¬ì„œ ë°˜ì˜ê°€ëŠ¥í•œ ë°©ë²•ì´ ë­ê°€ ìˆëŠ”ì§€ ë§í•´ì¤˜ 

â— Read(check_now.md)
  â¿  Read 115 lines

â— í…€í”„ë¡œì íŠ¸ ì ìˆ˜ íšë“ì„ ìœ„í•œ ê°€ì¥ ê°€ë³ê³  ì‹¤í–‰ ê°€ëŠ¥í•œ ê°œì„  ë°©ë²•ë“¤ì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤! ğŸš€

  ---
  ğŸ“Š ì¹´í…Œê³ ë¦¬ë³„ ìµœì†Œ ë¦¬ì†ŒìŠ¤ ê°œì„  ë°©ë²•

  1ï¸âƒ£ ìƒˆë¡œìš´ Feature ìƒì„± (ë‚œì´ë„: â­ | ì‹œê°„: 20-40ë¶„)

  âœ… ê°€ì¥ ì‰¬ìš´ ë°©ë²•ë“¤:

  A. Interaction Features (5ì¤„ ì¶”ê°€)
  # í•¨ìˆ˜ í•˜ë‚˜ë§Œ ì¶”ê°€í•˜ë©´ ë¨
  def add_interaction_features(df):
      df['temp_humid'] = df['temperature'] * df['humidity']
      df['cdh_thi'] = df['CDH'] * df['THI']
      df['temp_windspeed'] = df['temperature'] * df['windspeed']
      return df

  B. Time-based Bins (10ì¤„)
  def add_time_bins(df):
      conditions = [
          (df['hour'] >= 0) & (df['hour'] < 6),   # ìƒˆë²½
          (df['hour'] >= 6) & (df['hour'] < 12),  # ì˜¤ì „
          (df['hour'] >= 12) & (df['hour'] < 18), # ì˜¤í›„
          (df['hour'] >= 18) & (df['hour'] < 24)  # ì €ë…
      ]
      df['time_bin'] = np.select(conditions, [0, 1, 2, 3])
      return df

  C. Simple Lag Features (3ì¤„)
  def add_simple_lag(df):
      # 1ì£¼ì¼ ì „ ì „ë ¥ ì†Œë¹„ëŸ‰ (ì´ë¯¸ shift(168)ì´ ìˆìœ¼ë‹ˆ ë” ê°„ë‹¨)
      df['power_lag_24h'] = df.groupby('building_number')['power_consumption'].shift(24)
      return df

  ì¶”ì²œ: A + B ì¡°í•© (30ë¶„ ì†Œìš”, ì½”ë“œ 15ì¤„)

  ---
  2ï¸âƒ£ ì•™ìƒë¸” ì ìš© (ë‚œì´ë„: â­â­ | ì‹œê°„: 2-3ì‹œê°„)

  âœ… ê°€ì¥ ì‰¬ìš´ ë°©ë²•:

  A. Multi-seed Ensemble (ì½”ë“œ ìˆ˜ì • ì—†ì´ 3ë²ˆ ì‹¤í–‰)
  # ê¸°ì¡´ ì½”ë“œì—ì„œ SEEDë§Œ ë°”ê¿”ì„œ 3ë²ˆ ì‹¤í–‰
  SEED = 42  # â†’ ì œì¶œ1.csv
  SEED = 123 # â†’ ì œì¶œ2.csv
  SEED = 999 # â†’ ì œì¶œ3.csv

  # ë§ˆì§€ë§‰ì— í‰ê· 
  submission['answer'] = (pred1 + pred2 + pred3) / 3

  ì‹¤í–‰ ë°©ë²•:
  1. í˜„ì¬ ì½”ë“œ ê·¸ëŒ€ë¡œ ì‹¤í–‰ â†’ submission_seed42.csv ì €ì¥
  2. SEED = 123 ë³€ê²½ í›„ ì¬ì‹¤í–‰ â†’ submission_seed123.csv ì €ì¥
  3. SEED = 999 ë³€ê²½ í›„ ì¬ì‹¤í–‰ â†’ submission_seed999.csv ì €ì¥
  4. 3ê°œ í‰ê· ë‚´ê¸°

  ë¦¬ì†ŒìŠ¤: 3ì‹œê°„ (GPU ì‚¬ìš© ì‹œ), ì ìˆ˜ ëŒ€ë¹„ ê°€ì¥ íš¨ê³¼ì 

  B. Simple Model Ensemble (ì•½ê°„ ë” ë³µì¡)
  # TabPFN + Ridge Regression ì•™ìƒë¸”
  from sklearn.linear_model import Ridge

  # Ridge ëª¨ë¸ ì¶”ê°€
  ridge = Ridge(alpha=100)
  models = [tabpfn, ridge]  # 2ê°œ ëª¨ë¸ stacking

  # ë‚˜ë¨¸ì§€ëŠ” ë™ì¼

  ì¶”ì²œ: Multi-seed Ensemble (ì ìˆ˜ í–¥ìƒ í™•ì‹¤, ì½”ë“œ ìˆ˜ì • ê±°ì˜ ì—†ìŒ)

  ---
  3ï¸âƒ£ í•˜ì´í¼íŒŒë¼ë¯¸í„° ë³€ê²½ (ë‚œì´ë„: â­ | ì‹œê°„: 5-10ë¶„)

  âœ… ê°€ì¥ ì‰¬ìš´ ë°©ë²•ë“¤:

  A. CV Fold ìˆ˜ ë³€ê²½ (1ì¤„)
  CV_FOLDS = 5  # â†’ CV_FOLDS = 7 ë˜ëŠ” 10
  - íš¨ê³¼: ë” ì•ˆì •ì ì¸ ì˜ˆì¸¡ (1ë“±íŒ€ì€ 10 ì‚¬ìš©)
  - ì‹œê°„: 5-fold ëŒ€ë¹„ 1.4ë°°~2ë°° ì¦ê°€

  B. Scaler ë³€ê²½ (1ì¤„)
  scaler = StandardScaler()  # â†’ scaler = RobustScaler()
  - íš¨ê³¼: ì´ìƒì¹˜ì— ë” ê°•ê±´
  - ì‹œê°„: ë™ì¼

  C. CDH/CDD íŒŒë¼ë¯¸í„° íŠœë‹ (2ì¤„)
  # ê¸°ì¡´
  combined_df = add_cdh_feature(combined_df)
  # window=12, base_temp=26 (ê¸°ë³¸ê°’)

  # ë³€ê²½
  combined_df = add_cdh_feature(combined_df, window=18, base_temp=24)
  combined_df = add_cdd_feature(combined_df, window=36, base_temp=16)

  ì‹¤í—˜ ì¡°í•© (ê°ê° ë”°ë¡œ ì‹œë„):
  | ì‹¤í—˜  | CDH window | CDH base_temp | CDD window | CDD base_temp | ì„¤ëª…       |
  |-----|------------|---------------|------------|---------------|----------|
  | ì‹¤í—˜1 | 18         | 24            | 36         | 16            | ë” ê¸´ ìœˆë„ìš°  |
  | ì‹¤í—˜2 | 6          | 28            | 12         | 20            | ë” ì§§ì€ ìœˆë„ìš° |
  | ì‹¤í—˜3 | 12         | 25            | 24         | 17            | ë¯¸ì„¸ ì¡°ì •    |

  ì¶”ì²œ: B (RobustScaler) + C (ì‹¤í—˜1) ì¡°í•© â†’ 10ë¶„ ì†Œìš”

  ---
  4ï¸âƒ£ ìƒˆë¡œìš´ ì†”ë£¨ì…˜ (ë‚œì´ë„: â­â­â­ | ì‹œê°„: 3-4ì‹œê°„)

  âœ… ë¹„êµì  ì‰¬ìš´ ë°©ë²•:

  A. Weighted Ensemble (1ë“±íŒ€ ë°©ì‹ ê°„ì†Œí™”)
  # í˜„ì¬: TabPFN Stacking 1ê°œ
  # ì¶”ê°€: AutoGluon 1ê°œ (ì´ë¯¸ best_modelì— ì½”ë“œ ìˆìŒ)

  # ìµœì¢… ì•™ìƒë¸”
  final_answer = 0.7 * tabpfn_pred + 0.3 * autogluon_pred

  B. ê±´ë¬¼ íƒ€ì…ë³„ í›„ì²˜ë¦¬
  # ê±´ë¬¼ íƒ€ì…ë³„ë¡œ ë‹¤ë¥¸ ê°€ì¤‘ì¹˜ ì ìš©
  for building_type in df['building_type'].unique():
      mask = df['building_type'] == building_type
      if building_type == 'Department Store':
          df.loc[mask, 'prediction'] *= 1.02  # 2% ì¦ê°€
      elif building_type == 'School':
          df.loc[mask, 'prediction'] *= 0.98  # 2% ê°ì†Œ

  ì¶”ì²œ: A (AutoGluon ì¶”ê°€) - 1ë“±íŒ€ ì½”ë“œ í™œìš© ê°€ëŠ¥

  ---
  ğŸ¯ ìµœì¢… ì¶”ì²œ ì¡°í•© (ë¦¬ì†ŒìŠ¤ ìµœì†Œí™”)

  ğŸ“Œ Plan A: ìµœì†Œ ë¦¬ì†ŒìŠ¤ (3-4ì‹œê°„ ì´ ì†Œìš”)

  1. Interaction Features ì¶”ê°€ (30ë¶„)
    - temp_humid, cdh_thi ë“± 3-4ê°œ ì¶”ê°€
  2. RobustScaler + CDH/CDD íŒŒë¼ë¯¸í„° ë³€ê²½ (10ë¶„)
    - Scalerë§Œ ë°”ê¾¸ê¸°
    - window, base_temp ì¡°ì •
  3. 3-seed Ensemble (3ì‹œê°„)
    - SEED = 42, 123, 999ë¡œ 3ë²ˆ ì‹¤í–‰ í›„ í‰ê· 

  ì˜ˆìƒ ì ìˆ˜ íšë“:
  - Feature: +3ì 
  - Hyperparameter: +3ì 
  - Ensemble: +2ì 
  - ì´ +8ì 

  ---
  ğŸ“Œ Plan B: ì¤‘ê°„ ë¦¬ì†ŒìŠ¤ (5-6ì‹œê°„ ì´ ì†Œìš”)

  Plan A + AutoGluon ì¶”ê°€

  ì˜ˆìƒ ì ìˆ˜ íšë“: +10ì 

  ---
  ğŸ“Œ Plan C: ìµœëŒ€ íš¨ê³¼ (8-10ì‹œê°„ ì´ ì†Œìš”)

  Plan B + ê±´ë¬¼ íƒ€ì…ë³„ ëª¨ë¸

  ì˜ˆìƒ ì ìˆ˜ íšë“: +12-15ì 

  ---
  ğŸ’¡ ì‹¤í–‰ ìš°ì„ ìˆœìœ„

  1ìˆœìœ„ (ì¦‰ì‹œ ê°€ëŠ¥):
  â”œâ”€ RobustScaler ë³€ê²½ (5ë¶„)
  â”œâ”€ CDH/CDD íŒŒë¼ë¯¸í„° ë³€ê²½ (5ë¶„)
  â””â”€ Interaction Features ì¶”ê°€ (30ë¶„)

  2ìˆœìœ„ (ì˜¤ëŠ˜ ì¤‘):
  â””â”€ 3-seed Ensemble ì‹¤í–‰ (3ì‹œê°„)

  3ìˆœìœ„ (ì—¬ìœ  ìˆìœ¼ë©´):
  â””â”€ AutoGluon ì¶”ê°€ (2ì‹œê°„)

  ì´ ë°©ë²•ë“¤ì„ ì¡°í•©í•˜ë©´ ìµœì†Œ ë¦¬ì†ŒìŠ¤ë¡œ ìµœëŒ€ ì ìˆ˜ íšë“ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤! ì–´ë–¤ ì¡°í•©ìœ¼ë¡œ
  ì‹œì‘í•˜ì‹œê² ì–´ìš”?

> ë„ˆì˜ ì†”ë£¨ì…˜ ì¤‘ì— ê¶ê¸ˆí•œê±´, ì™œ ì €ê±¸ ì ìš©í–ˆëŠëƒë¥¼ ë‚´ê°€ í”„ë ˆì  í…Œì´ì…˜ í•´ì•¼í•˜ëŠ”ê±°ì•¼. ì™œ ridgeë¥¼     
ì•™ìƒë¸”ì„ í–ˆëƒ? ë¼ê³  í–ˆì„ ë•Œ ê·¸ ê·¼ê±°ë¥¼ ë§í•´ì¤˜. ë˜í•œ add_interaction_featureì˜ ìƒì„± ê·¼ê±°ëŠ”         
ë­”ì§€. ì™œ ì € ê°’ë“¤ì„ ê³±í–ˆëŠ”ì§€ë¥¼ ì„¤ëª…í•´ì•¼í•˜ê±°ë“ , ë„ˆëŠ” ì„¤ë“í•  ê·¼ê±°ë¥¼ í† ëŒ€ë¡œ ì„¤ëª…í•´ì¤„ ìˆ˜ ìˆì–´?        

â— ì¢‹ì€ ì§ˆë¬¸ì…ë‹ˆë‹¤! í”„ë ˆì  í…Œì´ì…˜ì—ì„œ **"ì™œ"**ë¥¼ ì„¤ëª…í•˜ëŠ” ê²ƒì´ í•µì‹¬ì´ì£ . ê° ë°©ë²•ì˜ ë…¼ë¦¬ì 
  ê·¼ê±°ë¥¼ ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

  ---
  1ï¸âƒ£ Ridge Regression ì•™ìƒë¸” ê·¼ê±°

  â“ ì™œ Ridgeë¥¼ ì¶”ê°€í–ˆëŠ”ê°€?

  A. ì•™ìƒë¸”ì˜ í•µì‹¬ ì›ë¦¬: Diversity (ë‹¤ì–‘ì„±)

  í•µì‹¬ ê°œë…: "ì„œë¡œ ë‹¤ë¥¸ ê°•ì ì„ ê°€ì§„ ëª¨ë¸ì„ ê²°í•©í•˜ë©´ ì„±ëŠ¥ í–¥ìƒ"

  ëª¨ë¸ë³„ íŠ¹ì„± ë¹„êµ:

  | ëª¨ë¸     | íƒ€ì…                  | ê°•ì           | ì•½ì               |
  |--------|---------------------|-------------|-----------------|
  | TabPFN | Transformer ê¸°ë°˜, ë¹„ì„ í˜• | ë³µì¡í•œ íŒ¨í„´ í•™ìŠµ   | ê³¼ì í•© ê°€ëŠ¥ì„±, ì•ˆì •ì„± ë‚®ìŒ |        
  | Ridge  | ì„ í˜• íšŒê·€ + L2 ì •ê·œí™”      | ì•ˆì •ì , ê³¼ì í•© ë°©ì§€ | ë¹„ì„ í˜• ê´€ê³„ í•™ìŠµ ì–´ë ¤ì›€   |      

  B. Bias-Variance Tradeoff

  TabPFN (Low Bias, High Variance) + Ridge (High Bias, Low Variance)
  = Balanced Model

  ì„¤ëª…:
  - TabPFNì€ ë³µì¡í•œ ëª¨ë¸ì´ë¼ í•™ìŠµ ë°ì´í„°ì— ê³¼í•˜ê²Œ ë§ì¶°ì§ˆ ìˆ˜ ìˆìŒ (High Variance)
  - RidgeëŠ” ë‹¨ìˆœí•œ ì„ í˜• ëª¨ë¸ì´ë¼ ì•ˆì •ì ì´ì§€ë§Œ í‘œí˜„ë ¥ì´ ì œí•œì  (High Bias)
  - ë‘˜ì„ ì¡°í•©í•˜ë©´ ì„œë¡œì˜ ì•½ì ì„ ë³´ì™„

  C. ì‹¤ì¦ì  ê·¼ê±°

  1. 1ë“±íŒ€ ì „ëµ ë¶„ì„:
    - 1ë“±íŒ€ë„ TabPFN + AutoGluon(ë‚´ë¶€ì ìœ¼ë¡œ ì—¬ëŸ¬ ëª¨ë¸ í¬í•¨) ì•™ìƒë¸”
    - ë‹¨ì¼ ëª¨ë¸ì´ ì•„ë‹Œ ì´ì§ˆì ì¸ ëª¨ë¸ ì¡°í•©ì´ í•µì‹¬
  2. Kaggle ìƒìœ„ê¶Œ ê³µí†µì :
    - ê±°ì˜ ëª¨ë“  ìƒìœ„ê¶Œì´ ì„œë¡œ ë‹¤ë¥¸ ì•Œê³ ë¦¬ì¦˜ ì•™ìƒë¸” ì‚¬ìš©
    - "No Free Lunch Theorem": ëª¨ë“  ë°ì´í„°ì— ì™„ë²½í•œ ë‹¨ì¼ ëª¨ë¸ì€ ì—†ìŒ

  D. ê³„ì‚° íš¨ìœ¨ì„±

  - RidgeëŠ” ë§¤ìš° ë¹ ë¥´ê²Œ í•™ìŠµë˜ë¯€ë¡œ ì¶”ê°€ ì‹œê°„ ë¹„ìš© ê±°ì˜ ì—†ìŒ
  - TabPFNì€ GPU í•„ìš”í•˜ì§€ë§Œ RidgeëŠ” CPUë§Œìœ¼ë¡œ ì¶©ë¶„

  ---
  ğŸ¤ í”„ë ˆì  í…Œì´ì…˜ ëŒ€ë³¸ ì˜ˆì‹œ:

  "TabPFNì€ Transformer ê¸°ë°˜ìœ¼ë¡œ ë³µì¡í•œ ë¹„ì„ í˜• íŒ¨í„´ì„ ì˜ í•™ìŠµí•˜ì§€ë§Œ, ì‘ì€ ë°ì´í„°ì…‹ì—ì„œ 
  ê³¼ì í•©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°˜ë©´ RidgeëŠ” ì„ í˜• ëª¨ë¸ì´ë¼ ì•ˆì •ì ì´ê³  L2 ì •ê·œí™”ë¡œ ê³¼ì í•©ì„ 
  ë°©ì§€í•©ë‹ˆë‹¤. 

  **ì•™ìƒë¸” í•™ìŠµì˜ í•µì‹¬ì€ ë‹¤ì–‘ì„±(Diversity)**ì…ë‹ˆë‹¤. ì„œë¡œ ë‹¤ë¥¸ ê°€ì •ì„ ê°€ì§„ ëª¨ë¸ì„ ê²°í•©í•˜ë©´, í•œ    
   ëª¨ë¸ì˜ ì˜¤ì°¨ë¥¼ ë‹¤ë¥¸ ëª¨ë¸ì´ ë³´ì™„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

  ì‹¤ì œë¡œ 1ë“±íŒ€ë„ TabPFNê³¼ AutoGluonì„ ì¡°í•©í–ˆê³ , Kaggle ìƒìœ„ê¶Œ ì†”ë£¨ì…˜ ëŒ€ë¶€ë¶„ì´ ì´ì§ˆì ì¸ ëª¨ë¸      
  ì•™ìƒë¸”ì„ ì‚¬ìš©í•©ë‹ˆë‹¤."

  ---
  2ï¸âƒ£ Interaction Features ìƒì„± ê·¼ê±°

  A. temp_humid (ì˜¨ë„ Ã— ìŠµë„)

  ë¬¼ë¦¬ì  ê·¼ê±°: ì²´ê° ì˜¨ë„(Apparent Temperature)

  í•µì‹¬ ê°œë…:
  - ê°™ì€ ì˜¨ë„ë¼ë„ ìŠµë„ì— ë”°ë¼ ì²´ê° ì˜¨ë„ê°€ ë‹¤ë¦„
  - ì˜¨ë„ 30Â°C + ìŠµë„ 90% = ë§¤ìš° ë¥ê²Œ ëŠê»´ì§ â†’ ëƒ‰ë°© ìˆ˜ìš” â†‘â†‘
  - ì˜¨ë„ 30Â°C + ìŠµë„ 40% = ëœ ë¥ê²Œ ëŠê»´ì§ â†’ ëƒ‰ë°© ìˆ˜ìš” â†‘

  ëƒ‰ë°© ë¶€í•˜ì™€ì˜ ê´€ê³„:
  ëƒ‰ë°© í•„ìš”ëŸ‰ âˆ ì˜¨ë„ Ã— ìŠµë„
  (ì‹¤ì œë¡œëŠ” ë” ë³µì¡í•˜ì§€ë§Œ, ë‹¨ìˆœ ê³±ìœ¼ë¡œ 1ì°¨ ê·¼ì‚¬)

  ASHRAE(ë¯¸êµ­ëƒ‰ë‚œë°©ê³µì¡°í•™íšŒ) ì—°êµ¬:
  - ê±´ë¬¼ ëƒ‰ë°© ë¶€í•˜ ê³„ì‚° ì‹œ ì˜¨ë„-ìŠµë„ ìƒí˜¸ì‘ìš© ê³ ë ¤
  - ìŠµë„ê°€ ë†’ìœ¼ë©´ ì¦ë°œì‹ ëƒ‰ê° íš¨ìœ¨ â†“ â†’ ë” ë§ì€ ì „ë ¥ í•„ìš”

  ê¸°ì¡´ Featureì™€ì˜ ì°¨ì´:

  - ì´ë¯¸ **THI(ì˜¨ë„-ìŠµë„ ì§€ìˆ˜)**ê°€ ìˆì§€ë§Œ, ë¹„ì„ í˜• ê³µì‹ ì‚¬ìš©
  - temp_humidëŠ” ë‹¨ìˆœ ê³±ìœ¼ë¡œ ë‹¤ë¥¸ í˜•íƒœì˜ ìƒí˜¸ì‘ìš© í¬ì°©
  - ëª¨ë¸ì´ ì—¬ëŸ¬ í˜•íƒœì˜ featureë¥¼ í•™ìŠµí•˜ë©´ ë” í’ë¶€í•œ í‘œí˜„ ê°€ëŠ¥

  ---
  B. cdh_thi (CDH Ã— THI)

  ë…¼ë¦¬ì  ê·¼ê±°: ì²´ê° ì˜¨ë„ë¥¼ ê³ ë ¤í•œ ëˆ„ì  ëƒ‰ë°© ìˆ˜ìš”

  ê° Feature ì˜ë¯¸:
  - CDH(Cooling Degree Hours): ëƒ‰ë°©ì´ í•„ìš”í–ˆë˜ ì‹œê°„ì˜ ëˆ„ì ëŸ‰
  - THI(Temperature-Humidity Index): ì²´ê° ì˜¨ë„ ì§€ìˆ˜

  ì™œ ê³±í•˜ëŠ”ê°€?:
  CDHë§Œ ë†’ë‹¤ê³  ì „ë ¥ ì†Œë¹„ê°€ í•­ìƒ ë¹„ë¡€í•˜ì§€ëŠ” ì•ŠìŒ
  â†’ ìŠµë„ê°€ ë‚®ìœ¼ë©´ ëƒ‰ë°© íš¨ìœ¨ì´ ì¢‹ì•„ì„œ ì „ë ¥ ì†Œë¹„ ì ì„ ìˆ˜ ìˆìŒ

  CDH Ã— THI = "ì²´ê° ì˜¨ë„ê°€ ë†’ì€ ìƒí™©ì—ì„œì˜ ëˆ„ì  ëƒ‰ë°© ìˆ˜ìš”"

  ì˜ˆì‹œ:
  | ìƒí™©     | CDH | THI  | CDH Ã— THI | ì „ë ¥ ì†Œë¹„ ì˜ˆìƒ |
  |--------|-----|------|-----------|----------|
  | ê±´ì¡°í•œ ë”ìœ„ | ë†’ìŒ  | ë³´í†µ   | ì¤‘ê°„        | ì¤‘ê°„       |
  | ì°œí†µë”ìœ„   | ë†’ìŒ  | ë§¤ìš°ë†’ìŒ | ë§¤ìš°ë†’ìŒ      | ë§¤ìš°ë†’ìŒ     |

  ---
  C. temp_windspeed (ì˜¨ë„ Ã— í’ì†)

  ë¬¼ë¦¬ì  ê·¼ê±°: ìì—° í™˜ê¸° íš¨ê³¼

  í•µì‹¬ ê°œë…:
  - ì˜¨ë„ê°€ ë†’ì•„ë„ ë°”ëŒì´ ê°•í•˜ê²Œ ë¶ˆë©´ ì²´ê° ì˜¨ë„ â†“
  - í’ì†ì´ ë†’ìœ¼ë©´ ìì—° í™˜ê¸° ê°€ëŠ¥ â†’ ëƒ‰ë°© ìˆ˜ìš” ê°ì†Œ

  ëƒ‰ë°© ì „ëµê³¼ì˜ ê´€ê³„:
  ì˜¨ë„ ë†’ìŒ + í’ì† ë‚®ìŒ = ëƒ‰ë°© ì˜ì¡´ë„ ìµœëŒ€
  ì˜¨ë„ ë†’ìŒ + í’ì† ë†’ìŒ = ìì—° í™˜ê¸° ê°€ëŠ¥, ëƒ‰ë°© ì˜ì¡´ë„ ê°ì†Œ

  ê±´ë¬¼ ì—ë„ˆì§€ ê´€ë¦¬ ê´€ì :
  - ë§ì€ ê±´ë¬¼ì´ ì™¸ê¸° ì˜¨ë„ì™€ í’ì†ì„ ê³ ë ¤í•œ ì™¸ê¸° ëƒ‰ë°©(Free Cooling) ì‚¬ìš©
  - í’ì†ì´ ì¶©ë¶„í•˜ë©´ ì°½ë¬¸/í™˜ê¸°êµ¬ ê°œë°©ìœ¼ë¡œ ëƒ‰ë°© ì „ë ¥ ì ˆê°

  ---
  ğŸ¤ í”„ë ˆì í…Œì´ì…˜ ëŒ€ë³¸ ì˜ˆì‹œ:

  "ì „ë ¥ ì†Œë¹„ëŠ” ë‹¨ì¼ ê¸°ìƒ ë³€ìˆ˜ê°€ ì•„ë‹Œ ì—¬ëŸ¬ ë³€ìˆ˜ì˜ ìƒí˜¸ì‘ìš©ì— ì˜í•´ ê²°ì •ë©ë‹ˆë‹¤.

  temp_humid: ê°™ì€ ì˜¨ë„ë¼ë„ ìŠµë„ê°€ ë†’ìœ¼ë©´ ì²´ê° ì˜¨ë„ê°€ ì˜¬ë¼ê°€ê³ , ì¦ë°œì‹ ëƒ‰ê° íš¨ìœ¨ì´ ë–¨ì–´ì ¸ ë”     
  ë§ì€ ëƒ‰ë°© ì „ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤. ASHRAE(ë¯¸êµ­ëƒ‰ë‚œë°©ê³µì¡°í•™íšŒ) ì—°êµ¬ì—ì„œë„ ëƒ‰ë°© ë¶€í•˜ ê³„ì‚° ì‹œ 
  ì˜¨ë„-ìŠµë„ ìƒí˜¸ì‘ìš©ì„ ê³ ë ¤í•©ë‹ˆë‹¤.

  cdh_thi: CDHëŠ” ëƒ‰ë°©ì´ í•„ìš”í–ˆë˜ ì‹œê°„ì˜ ëˆ„ì ëŸ‰ì´ê³ , THIëŠ” ì²´ê° ì˜¨ë„ì…ë‹ˆë‹¤. ë‹¨ìˆœíˆ CDHê°€ 
  ë†’ë‹¤ê³  ì „ë ¥ ì†Œë¹„ê°€ ë¹„ë¡€í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ìŠµë„ê°€ ë‚®ìœ¼ë©´ ëƒ‰ë°© íš¨ìœ¨ì´ ì¢‹ì•„ì„œ ê°™ì€ CDHë¼ë„ ì „ë ¥       
  ì†Œë¹„ê°€ ì ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ CDH Ã— THIë¡œ 'ì²´ê° ì˜¨ë„ê°€ ë†’ì€ ìƒí™©ì—ì„œì˜ ëˆ„ì  ëƒ‰ë°© ìˆ˜ìš”'ë¥¼     
  í‘œí˜„í–ˆìŠµë‹ˆë‹¤.

  temp_windspeed: ì˜¨ë„ê°€ ë†’ì•„ë„ ë°”ëŒì´ ê°•í•˜ê²Œ ë¶ˆë©´ ìì—° í™˜ê¸°ê°€ ê°€ëŠ¥í•´ ëƒ‰ë°© ì˜ì¡´ë„ê°€ 
  ë‚®ì•„ì§‘ë‹ˆë‹¤. ë§ì€ ê±´ë¬¼ì´ ì™¸ê¸° ì˜¨ë„ì™€ í’ì†ì„ ê³ ë ¤í•œ ì™¸ê¸° ëƒ‰ë°©(Free Cooling)ì„ ì‚¬ìš©í•©ë‹ˆë‹¤."       

  ---
  3ï¸âƒ£ ë” ì„¤ë“ë ¥ ìˆëŠ” ëŒ€ì•ˆ ì œì•ˆ

  ë§Œì•½ ìœ„ ì„¤ëª…ì´ ì•½í•˜ë‹¤ê³  ëŠê»´ì§„ë‹¤ë©´, ë” ëª…í™•í•œ ë„ë©”ì¸ ê·¼ê±°ê°€ ìˆëŠ” featureë¥¼ ì œì•ˆí•©ë‹ˆë‹¤:

  ğŸ”¥ ì¶”ì²œ ëŒ€ì²´ Feature

  A. cooling_intensity (ëƒ‰ë°© ê°•ë„)

  df['cooling_intensity'] = np.maximum(0, df['temperature'] - 26) * (df['humidity'] / 100)       

  ê·¼ê±°:
  - 26ë„ ì´ìƒì¼ ë•Œë§Œ ëƒ‰ë°© í•„ìš” (ì¼ë°˜ì ì¸ ì¾Œì  ì˜¨ë„)
  - ìŠµë„ê°€ ë†’ì„ìˆ˜ë¡ ëƒ‰ë°© íš¨ìœ¨ â†“ â†’ ê°•ë„ â†‘
  - ë¬¼ë¦¬ì ìœ¼ë¡œ ëª…í™•í•œ ì˜ë¯¸

  ---
  B. heat_stress_index (ì—´ ìŠ¤íŠ¸ë ˆìŠ¤ ì§€ìˆ˜)

  # ì˜¨ë„ì™€ ìŠµë„ê°€ ëª¨ë‘ ë†’ì„ ë•Œë§Œ í™œì„±í™”
  df['heat_stress'] = (df['temperature'] > 28) & (df['humidity'] > 70)
  df['heat_stress_index'] = df['heat_stress'] * df['temperature'] * df['humidity']

  ê·¼ê±°:
  - ì˜¨ë„ 28ë„ ì´ìƒ + ìŠµë„ 70% ì´ìƒ = "ì°œí†µ ë”ìœ„"
  - ì´ ì¡°ê±´ì—ì„œë§Œ ê·¹ë‹¨ì ì¸ ëƒ‰ë°© ìˆ˜ìš” ë°œìƒ
  - ì´ì§„ ì¡°ê±´ Ã— ì—°ì†ê°’ = ëª…í™•í•œ ì„ê³„ê°’ í‘œí˜„

  ---
  C. ventilation_potential (í™˜ê¸° ê°€ëŠ¥ì„±)

  # ì˜¨ë„ê°€ ì ë‹¹í•˜ê³  í’ì†ì´ ì¶©ë¶„í•  ë•Œ ìì—° í™˜ê¸° ê°€ëŠ¥
  df['ventilation_potential'] = (df['windspeed'] > 2) & (df['temperature'] < 28)

  ê·¼ê±°:
  - í’ì† 2m/s ì´ìƒì´ë©´ íš¨ê³¼ì ì¸ ìì—° í™˜ê¸° ê°€ëŠ¥
  - ì˜¨ë„ 28ë„ ì´í•˜ë©´ ì™¸ê¸° ë„ì… ìœ ë¦¬
  - ê±´ë¬¼ ì—ë„ˆì§€ ê´€ë¦¬ ì‹¤ë¬´ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê°œë…

  ---
  ğŸ¯ ìµœì¢… ì¶”ì²œ ì¡°í•© (ì„¤ë“ë ¥ ê¸°ì¤€)

  Plan A: ì„¤ëª…í•˜ê¸° ì‰¬ìš´ ì¡°í•©

  # 1. ë¬¼ë¦¬ì  ì˜ë¯¸ê°€ ëª…í™•í•œ Feature
  df['cooling_intensity'] = np.maximum(0, df['temperature'] - 26) * (df['humidity'] / 100)       

  # 2. ì„ê³„ê°’ ê¸°ë°˜ Feature
  df['heat_stress'] = ((df['temperature'] > 28) & (df['humidity'] > 70)).astype(int)

  # 3. ê±´ë¬¼ ì—ë„ˆì§€ ê´€ë¦¬ ì‹¤ë¬´ ê°œë…
  df['ventilation_potential'] = ((df['windspeed'] > 2) & (df['temperature'] <
  28)).astype(int)

  í”„ë ˆì  í…Œì´ì…˜ ì¥ì :
  - ê° featureì˜ ë¬¼ë¦¬ì  ì˜ë¯¸ê°€ ëª…í™•
  - 26ë„, 28ë„ ë“± ì‹¤ë¬´ ê¸°ì¤€ ì˜¨ë„ ì‚¬ìš© (ì„¤ë“ë ¥ â†‘)
  - ì§ˆë¬¸ì— ëŒ€í•œ ë‹µë³€ì´ ëª…í™•í•¨

  ---
  Plan B: Ridge ëŒ€ì‹  ë” ì„¤ë“ë ¥ ìˆëŠ” ëª¨ë¸

  LightGBM ë˜ëŠ” CatBoost ì¶”ì²œ:

  # Ridge ëŒ€ì‹ 
  from lightgbm import LGBMRegressor

  lgbm = LGBMRegressor(n_estimators=100, learning_rate=0.05)
  models = [tabpfn, lgbm]

  ê·¼ê±°:
  - TabPFN: Transformer ê¸°ë°˜ (attention mechanism)
  - LightGBM: Tree ê¸°ë°˜ (decision rules)
  - ì™„ì „íˆ ë‹¤ë¥¸ í•™ìŠµ ë°©ì‹ â†’ ë” ëª…í™•í•œ diversity

  í”„ë ˆì  í…Œì´ì…˜:
  "TabPFNì€ attention ê¸°ë°˜ìœ¼ë¡œ ì „ì—­ì  íŒ¨í„´ì„ í•™ìŠµí•˜ê³ , LightGBMì€ tree ê¸°ë°˜ìœ¼ë¡œ êµ­ì†Œì  ê·œì¹™ì„    
   í•™ìŠµí•©ë‹ˆë‹¤. ì„œë¡œ ë‹¤ë¥¸ ê·€ë‚©ì  í¸í–¥(inductive bias)ì„ ê°€ì§„ ëª¨ë¸ì„ ê²°í•©í•˜ë©´ ìƒí˜¸ ë³´ì™„ë©ë‹ˆë‹¤."    

  ---
  ğŸ“ ì •ë¦¬

  | í•­ëª©             | ì›ë˜ ì œì•ˆ          | ì„¤ë“ë ¥             | ëŒ€ì•ˆ
     |
  |----------------|----------------|-----------------|------------------------------|
  | Ridge ì•™ìƒë¸”      | TabPFN + Ridge | â­â­â­ (ì¶©ë¶„íˆ ì„¤ëª… ê°€ëŠ¥) | LightGBM/CatBoost
  (â­â­â­â­â­)    |
  | temp_humid     | ì˜¨ë„ Ã— ìŠµë„        | â­â­â­ (ASHRAE ê·¼ê±°) | cooling_intensity
  (â­â­â­â­â­)    |
  | cdh_thi        | CDH Ã— THI      | â­â­ (ì•½ê°„ ë³µì¡)      | heat_stress_index (â­â­â­â­)       
    |
  | temp_windspeed | ì˜¨ë„ Ã— í’ì†        | â­â­â­ (ìì—° í™˜ê¸°)     | ventilation_potential
  (â­â­â­â­) |

  ì›ë˜ ì œì•ˆë„ ì¶©ë¶„íˆ ì„¤ë“ë ¥ ìˆì§€ë§Œ, ëŒ€ì•ˆì´ ë” ëª…í™•í•˜ê³  ì„¤ëª…í•˜ê¸° ì‰½ìŠµë‹ˆë‹¤.

  ì–´ë–¤ ë°©í–¥ìœ¼ë¡œ ì§„í–‰í•˜ì‹œê² ì–´ìš”?